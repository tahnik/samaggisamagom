!function(e){function t(r){if(n[r])return n[r].exports;var o=n[r]={exports:{},id:r,loaded:!1};return e[r].call(o.exports,o,o.exports,t),o.loaded=!0,o.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){(function(e){"use strict";var t=n(1),r=t(),o=n(2),a=n(31),s=n(39),i=n(42),u=n(40),l=n(43),c=n(30),f=u.createWriteStream(c.join("./",e,"logs/access.log"),{flags:"a"});r.use(l("combined",{stream:f})),r.use(i()),r.use("/api",a),r.use("/bin",t["static"]("./bin")),r.use("/stylesheets",t["static"]("./public/stylesheets")),r.use("/resources",t["static"]("./public/resources")),r.use("/javascripts",t["static"]("./public/javascripts")),r.use("/news_images",s),r.use("/",o),r.use("/view/*",o),r.use("/signin",o),r.use("/news",o),r.use("/news/*",o),r.use("/create/*",o),r.use("/signup",o),r.listen(3e3,function(){console.log("Hello World listening on port 3000!")})}).call(t,"/")},function(e,t){e.exports=require("express")},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t,n){return'\n    <!DOCTYPE html>\n    <html lang="en">\n    <head>\n    \t<!-- Required meta tags always come first -->\n    \t<meta charset="utf-8">\n    \t<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">\n    \t<meta http-equiv="x-ua-compatible" content="ie=edge">\n        <meta name="author" content="Tahnik Mustasin">\n        <meta name="Copyright" content="Tahnik Mustasin" />\n        <meta name="Robots" content="INDEX,ALL" />\n        <meta name="YahooSeeker" content="INDEX, FOLLOW" />\n        <meta name="msnbot" content="INDEX, FOLLOW" />\n        <meta name="googlebot" content="INDEX, FOLLOW" />\n        <meta name="allow-search" content="yes" />\n        <meta name="revisit-after" content="daily" />\n        <meta name="Rating" content="General" />\n        <meta name="site" content="http://www.samaggisamagom.org" />\n        <meta name="distribution" content="global" />\n        <meta name="keywords" content="samaggi, samagom, thai, society, samaggisamagom">\n        <!--Setting some keyword for search engines -->\n        <meta name="description" content="A society for Thai Society Samaggi Conenct">\n        <!-- Setting a description -->\n        <meta name="language" content="English" />\n        <title>SamaggiSamagom</title>\n\n    \t<!-- Bootstrap CSS -->\n        <style>\n            '+n.data+'\n        </style>\n\n        <link rel="shortcut icon" href="../resources/favicon.ico">\n        <style>\n.main,.row,.vertical-center{position:relative}.top_nav,.vertical-center{top:50%;transform:translateY(-50%)}#exCollapsingNavbar2>ul>li>input,.top_nav_buttons{border-radius:0;box-shadow:0 1px 3px grey}.row{margin:0}#reactbody{text-align:center}.main{margin-top:5vh}.top_nav{right:0;position:absolute}@media (min-width:992px){#exCollapsingNavbar2>ul>li>input{width:30vw}}@media (max-width:992px){.top_nav{position:relative;top:0;transform:translateY(0)}.navbar{margin:0 auto}#exCollapsingNavbar2>ul>li.nav-item{float:none;margin:8px 0}}.top_nav_buttons{background-color:#e04226;color:#fff}.news_main_link{color:#696969}.news_main_link:hover{color:#2e2e2e}.news_main_link:visited{color:#696969}.dropdown-item{color:#fff}        </style>\n    </head>\n    <body>\n\n    \t<div id="reactbody"><div>'+e+"</div></div>\n        <script>\n            window.__INITIAL_STATE__ = "+JSON.stringify(t)+'\n          </script>\n    \t<script src="../bin/app.bundle.js"></script>\n    \t<!-- jQuery first, then Bootstrap JS. -->\n    \t<script src="../javascripts/tether.min.js"></script>\n    \t<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>\n    \t<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.2/js/bootstrap.min.js" integrity="sha384-vZ2WRJMwsjRMW/8U7i6PWi6AlO1L79snBrmgiDpgIWJ82z8eA5lenwvxbMV1PAh7" crossorigin="anonymous"></script>\n    </body>\n    </html>\n    '}var a=n(3),s=n(4),i=n(5),u=r(i),l=n(26),c=r(l),f=n(10),p=n(11),d=n(27),m=n(13),y=n(12),h=r(y),b=n(1),g=b.Router(),v=(n(30),n(6));n(40);g.get("/",function(e,t){(0,s.match)({routes:u["default"],location:e.originalUrl},function(e,n,r){if(e)t.status(500).send(e.message);else if(n)t.redirect(302,n.pathname+n.search);else if(r){var i;!function(){var e=(0,d.createStore)(c["default"]);i=f.ROOT_URL_SECURE+"/api/news/top",h["default"].get(i).then(function(n){e.dispatch({type:p.TOP_NEWS,payload:n});var i=(0,a.renderToString)(v.createElement(m.Provider,{store:e},v.createElement(s.RouterContext,r))),u=e.getState(),l="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.2/css/bootstrap.min.css";h["default"].get(l).then(function(e){t.status(200).send(o(i,u,e))})["catch"](function(){console.log("There's a problem")})})["catch"](function(){console.log("There's a problem")})}()}else t.status(404).send("Not found")})}),e.exports=g},function(e,t){e.exports=require("react-dom/server")},function(e,t){e.exports=require("react-router")},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(6),a=r(o),s=n(4),i=n(7),u=r(i),l=n(14),c=r(l),f=n(18),p=r(f),d=n(21),m=r(d),y=n(22),h=r(y),b=n(23),g=r(b),v=n(24),w=r(v),E=n(25),_=r(E);t["default"]=a["default"].createElement(s.Router,{history:s.browserHistory},a["default"].createElement(s.Route,{path:"/",component:_["default"]},a["default"].createElement(s.IndexRoute,{component:u["default"]}),a["default"].createElement(s.Route,{path:"/signin",component:p["default"]}),a["default"].createElement(s.Route,{path:"/signup",component:m["default"]}),a["default"].createElement(s.Route,{path:"/create/news",component:(0,w["default"])(g["default"])}),a["default"].createElement(s.Route,{path:"/news",component:c["default"]}),a["default"].createElement(s.Route,{path:"/news/:id",component:h["default"]})))},function(e,t){e.exports=require("react")},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(6),l=r(u),c=n(8),f=r(c),p=function(e){function t(){return o(this,t),a(this,Object.getPrototypeOf(t).apply(this,arguments))}return s(t,e),i(t,[{key:"render",value:function(){return l["default"].createElement("div",{className:"row"},l["default"].createElement(f["default"],null))}}]),t}(u.Component);t["default"]=p},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function i(e){return{allNews:e.allNews}}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(6),c=r(l),f=n(9),p=r(f),d=n(11),m=n(13),y=function(e){function t(){return o(this,t),a(this,Object.getPrototypeOf(t).apply(this,arguments))}return s(t,e),u(t,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){return 0==this.props.allNews.length?c["default"].createElement("div",null,"Loading..."):c["default"].createElement("div",{className:"col-md-6",style:{marginTop:"1em",marginLeft:"2vw"}},this.props.allNews.map(function(e){return c["default"].createElement(p["default"],{key:e.id,news:e})}))}}]),t}(l.Component);t["default"]=(0,m.connect)(i,{getTopNews:d.getTopNews})(y)},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(6),l=r(u),c=n(4),f=n(10),p=function(e){function t(){return o(this,t),a(this,Object.getPrototypeOf(t).apply(this,arguments))}return s(t,e),i(t,[{key:"render",value:function(){var e=f.ROOT_URL+"/news_images/"+this.props.news.image_path,t=200,n=this.props.news.body.substr(0,t);return n=n.substr(0,Math.min(n.length,n.lastIndexOf(" ")))+"...",this.props.news.body.length<300&&(n=this.props.news.body),l["default"].createElement("div",{className:"card"},l["default"].createElement("div",{className:"card-block"},l["default"].createElement("h4",{className:"card-title"},this.props.news.title),l["default"].createElement("h6",{className:"card-subtitle text-muted"},this.props.news.created_on.replace(/T|Z/g," "))),l["default"].createElement("img",{style:{width:"100%"},src:e,alt:"Card image"}),l["default"].createElement("div",{className:"card-block"},l["default"].createElement("p",{className:"card-text"},n),l["default"].createElement(c.Link,{to:"/news/"+this.props.news.id},l["default"].createElement("button",{type:"button",className:"btn btn-primary"},"Read more"))))}}]),t}(u.Component);t["default"]=p},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ROOT_URL="http://www.samaggisamagom.org",t.ROOT_URL_SECURE="https://www.samaggisamagom.org"},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e){return function(t){var n=p.ROOT_URL_SECURE+"/api/news?page="+e;f["default"].get(n).then(function(n){t({type:m,payload:n}),t({type:v,payload:n,page:e})})["catch"](function(){t(l("Bad Login Info"))})}}function a(){return function(e){var t=p.ROOT_URL_SECURE+"/api/news/top";f["default"].get(t).then(function(t){e({type:y,payload:t})})["catch"](function(){e(l("Bad Login Info"))})}}function s(e){return function(t){var n=p.ROOT_URL_SECURE+"/api/news",r=new FormData;Object.keys(e).forEach(function(t){"news_image"==t?r.append(t,e[t][0]):r.append(t,e[t])}),r.append("token",localStorage.getItem("token")),f["default"].post(n,r).then(function(e){t({type:h,payload:e}),d.browserHistory.push("/")})["catch"](function(){t(l("Bad Login Info"))})}}function i(e){return function(t){var n=p.ROOT_URL_SECURE+"/api/news/"+e;f["default"].get(n).then(function(e){t({type:b,payload:e})})["catch"](function(){t(l("Bad Login Info"))})}}function u(){return function(e){var t={data:{news:null}};e({type:b,payload:t})}}function l(e){return{type:g,payload:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.PAGINATION_NEWS=t.AUTH_ERROR=t.ACTIVE_NEWS=t.CREATE_POST=t.TOP_NEWS=t.PAGE_NEWS=void 0,t.getNewsWithPage=o,t.getTopNews=a,t.createPost=s,t.getNews=i,t.destroyActiveNews=u,t.authError=l;var c=n(12),f=r(c),p=n(10),d=n(4),m=t.PAGE_NEWS="PAGE_NEWS",y=t.TOP_NEWS="TOP_NEWS",h=t.CREATE_POST="CREATE_POST",b=t.ACTIVE_NEWS="ACTIVE_NEWS",g=t.AUTH_ERROR="AUTH_ERROR",v=t.PAGINATION_NEWS="PAGINATION_NEWS"},function(e,t){e.exports=require("axios")},function(e,t){e.exports=require("react-redux")},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(6),l=r(u),c=n(15),f=r(c),p=function(e){function t(){return o(this,t),a(this,Object.getPrototypeOf(t).apply(this,arguments))}return s(t,e),i(t,[{key:"render",value:function(){return l["default"].createElement("div",{className:"row"},l["default"].createElement(f["default"],{params:this.props}))}}]),t}(u.Component);t["default"]=p},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function i(e){return{allNews:e.allNews,news_pagination:e.news_pagination}}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(6),c=r(l),f=n(16),p=r(f),d=n(11),m=n(13),y=n(17),h=r(y),b=function(e){function t(){return o(this,t),a(this,Object.getPrototypeOf(t).apply(this,arguments))}return s(t,e),u(t,[{key:"componentDidMount",value:function(){this.props.params.location.query.page?this.props.getNewsWithPage(parseInt(this.props.params.location.query.page)):this.props.getNewsWithPage(1)}},{key:"componentDidUpdate",value:function(){null!=this.props.news_pagination.page&&this.props.news_pagination.page!=this.props.params.location.query.page&&"undefined"!=typeof this.props.params.location.query.page&&(this.props.params.location.query.page?this.props.getNewsWithPage(parseInt(this.props.params.location.query.page)):this.props.getNewsWithPage(1)),window.scrollTo(0,0)}},{key:"renderNews",value:function(){var e=0,t=[];return this.props.allNews.map(function(n){3===e&&t.push(c["default"].createElement("div",{className:"col-md-12",style:{marginBottom:"20px"}})),t.push(c["default"].createElement(p["default"],{key:n.id,news:n})),e++}),t}},{key:"render",value:function(){return 0==this.props.allNews.length?c["default"].createElement("div",null,"Loading..."):c["default"].createElement("div",{className:"col-md-offset-1 col-md-10",style:{marginTop:"1em"}},c["default"].createElement("div",{className:"row"},this.renderNews()),c["default"].createElement(h["default"],{currentPage:this.props.news_pagination.page,maxPage:this.props.news_pagination.maxPage,root_url:"/news"}))}}]),t}(l.Component);t["default"]=(0,m.connect)(i,{getNewsWithPage:d.getNewsWithPage})(b)},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(6),l=r(u),c=n(4),f=n(10),p=function(e){function t(){return o(this,t),a(this,Object.getPrototypeOf(t).apply(this,arguments))}return s(t,e),i(t,[{key:"render",value:function(){var e=f.ROOT_URL+"/news_images/"+this.props.news.image_path,t=200,n=this.props.news.body.substr(0,t);return n=n.substr(0,Math.min(n.length,n.lastIndexOf(" ")))+"...",this.props.news.body.length<300&&(n=this.props.news.body),l["default"].createElement(c.Link,{className:"news_main_link",to:"/news/"+this.props.news.id},l["default"].createElement("div",{className:"col-md-4"},l["default"].createElement("div",{className:"card item news_main_card",style:{border:"none"}},l["default"].createElement("img",{style:{width:"100%"},src:e,alt:"Card image"}),l["default"].createElement("div",{className:"card-block"},l["default"].createElement("h4",{className:"card-title"},this.props.news.title)))))}}]),t}(u.Component);t["default"]=p},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(6),l=r(u),c=n(4),f=function(e){function t(){return o(this,t),a(this,Object.getPrototypeOf(t).apply(this,arguments))}return s(t,e),i(t,[{key:"renderNonActive",value:function(){var e=[],t=1,n=this.props.maxPage>6?5:this.props.maxPage;this.props.currentPage>=3&&this.props.maxPage>6&&(t=this.props.currentPage-2,this.props.currentPage+2>this.props.maxPage?(n=this.props.currentPage+(this.props.maxPage-this.props.currentPage),t=this.props.currentPage-(this.props.currentPage+2-n)-2):n=this.props.currentPage+2);for(var r=t;r<=n;r++)r==this.props.currentPage?e.push(l["default"].createElement("li",{key:r,className:"page-item active"},l["default"].createElement(c.Link,{to:this.props.root_url+"?page="+r,className:"page-link"},r," ",l["default"].createElement("span",{className:"sr-only"},"(current)")))):e.push(l["default"].createElement("li",{key:r,className:"page-item"},l["default"].createElement(c.Link,{to:this.props.root_url+"?page="+r,className:"page-link"},r)));return e}},{key:"render",value:function(){return l["default"].createElement("nav",{"aria-label":"..."},l["default"].createElement("ul",{className:"pagination"},l["default"].createElement("li",{className:"page-item"},l["default"].createElement(c.Link,{className:"page-link",to:this.props.root_url+"?page=1","aria-label":"Previous"},l["default"].createElement("span",{"aria-hidden":"true"},"«"),l["default"].createElement("span",{className:"sr-only"},"Previous"))),this.renderNonActive(),l["default"].createElement("li",{className:"page-item"},l["default"].createElement(c.Link,{className:"page-link",to:this.props.root_url+"?page="+this.props.maxPage,"aria-label":"Next"},l["default"].createElement("span",{"aria-hidden":"true"},"»"),l["default"].createElement("span",{className:"sr-only"},"Next")))))}}]),t}(u.Component);t["default"]=f},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(6),c=r(l),f=n(19),p=n(20),d=n(4),m=function(e){function t(){return o(this,t),a(this,Object.getPrototypeOf(t).apply(this,arguments))}return s(t,e),u(t,[{key:"onSubmit",value:function(e){this.props.signin(e)}},{key:"render",value:function(){var e=this,t=this.props,n=t.fields,r=n.email,o=n.password,a=t.handleSubmit;return c["default"].createElement("div",{className:"row"},c["default"].createElement("div",{className:"col-md-offset-4 col-md-4",style:{marginTop:"1em"}},c["default"].createElement("form",{onSubmit:a(function(t){return e.onSubmit(t)})},c["default"].createElement("h3",null,"Sign in"),c["default"].createElement("div",{className:"form-group"},c["default"].createElement("label",null,"Email"),c["default"].createElement("input",i({type:"text",className:"form-control"},r))),c["default"].createElement("div",{className:"form-group"},c["default"].createElement("label",null,"Password"),c["default"].createElement("input",i({type:"password",className:"form-control"},o))),c["default"].createElement("button",{type:"submit",className:"btn btn-primary"},"Sign in"),c["default"].createElement(d.Link,{to:"/",className:"btn btn-danger",style:{marginLeft:10}},"Cancel"),c["default"].createElement("br",null)," ",c["default"].createElement("br",null),c["default"].createElement(d.Link,{to:"/signup"},"Not Registered?"))))}}]),t}(l.Component);t["default"]=(0,f.reduxForm)({form:"PostsNewNews",fields:["email","password"]},null,{signin:p.signin})(m)},function(e,t){e.exports=require("redux-form")},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(){return function(e){var t=localStorage.getItem("token");if(t){var n=f.ROOT_URL_SECURE+"/api/verifyToken",r=new URLSearchParams;r.append("token",t),c["default"].post(n,r).then(function(t){return t.data.success?void e({type:d,payload:t}):void localStorage.removeItem("token")})["catch"](function(){e(u("Bad Login Info"))})}}}function a(e){return function(t){var n=f.ROOT_URL_SECURE+"/api/signin",r=new URLSearchParams;r.append("email",e.email),r.append("password",e.password),r.append("expiresIn","10h"),c["default"].post(n,r).then(function(e){return e.data.success?(t({type:d,payload:e,role:e.data.role}),localStorage.setItem("token",e.data.token),localStorage.setItem("role",e.data.role),void p.browserHistory.push("/")):void t(u("Bad Login Info"))})["catch"](function(){t(u("Bad Login Info"))})}}function s(e){return function(t){var n=f.ROOT_URL_SECURE+"/api/signup",r=new URLSearchParams;r.append("email",e.email),r.append("password",e.password),r.append("expiresIn","10h"),c["default"].post(n,r).then(function(e){return e.data.success?(t({type:d,payload:e,role:e.data.role}),localStorage.setItem("token",e.data.token),localStorage.setItem("role",e.data.role),void p.browserHistory.push("/")):void t(u("Bad Login Info"))})["catch"](function(){t(u("Bad Login Info"))})}}function i(){return localStorage.removeItem("token"),localStorage.removeItem("role"),{type:m}}function u(e){return{type:y,payload:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.AUTH_ERROR=t.UNAUTH_USER=t.AUTH_USER=void 0,t.checkLocalAuth=o,t.signin=a,t.signup=s,t.signout=i,t.authError=u;var l=n(12),c=r(l),f=n(10),p=n(4),d=t.AUTH_USER="AUTH_USER",m=t.UNAUTH_USER="UNAUTH_USER",y=t.AUTH_ERROR="AUTH_ERROR"},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(6),c=r(l),f=n(19),p=n(20),d=n(4),m=function(e){function t(){return o(this,t),a(this,Object.getPrototypeOf(t).apply(this,arguments))}return s(t,e),u(t,[{key:"onSubmit",value:function(e){this.props.signup(e)}},{key:"render",value:function(){var e=this,t=this.props,n=t.fields,r=n.email,o=n.password,a=t.handleSubmit;return c["default"].createElement("div",{className:"row"},c["default"].createElement("div",{className:"col-md-offset-4 col-md-4",style:{marginTop:"1em"}},c["default"].createElement("form",{onSubmit:a(function(t){return e.onSubmit(t)})},c["default"].createElement("h3",null,"Sign up"),c["default"].createElement("div",{className:"form-group"},c["default"].createElement("label",null,"Email"),c["default"].createElement("input",i({type:"text",className:"form-control"},r))),c["default"].createElement("div",{className:"form-group"},c["default"].createElement("label",null,"Password"),c["default"].createElement("input",i({type:"password",className:"form-control"},o))),c["default"].createElement("button",{type:"submit",className:"btn btn-primary"},"Sign up"),c["default"].createElement(d.Link,{to:"/",className:"btn btn-danger",style:{marginLeft:10}},"Cancel"))))}}]),t}(l.Component);t["default"]=(0,f.reduxForm)({form:"PostsNewNews",fields:["email","password"]},null,{signup:p.signup})(m)},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function i(e){return{activeNews:e.activeNews}}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(6),c=r(l),f=n(11),p=n(13),d=n(10),m=function(e){function t(){return o(this,t),a(this,Object.getPrototypeOf(t).apply(this,arguments))}return s(t,e),u(t,[{key:"componentWillUnmount",value:function(){this.props.destroyActiveNews()}},{key:"componentDidMount",value:function(){this.props.getNews(this.props.params.id)}},{key:"render",value:function(){if(!this.props.activeNews)return c["default"].createElement("div",null,"loading...");var e=d.ROOT_URL+"/news_images/"+this.props.activeNews.image_path;return c["default"].createElement("div",{className:"container"},c["default"].createElement("div",{className:"col-md-10"},c["default"].createElement("div",{className:"card"},c["default"].createElement("div",{className:"card-block"},c["default"].createElement("h4",{className:"card-title"},this.props.activeNews.title),c["default"].createElement("h6",{className:"card-subtitle text-muted"},this.props.activeNews.created_on.replace(/T|Z/g," "))),c["default"].createElement("img",{style:{width:"100%"},src:e,alt:"Card image"}),c["default"].createElement("div",{className:"card-block"},c["default"].createElement("p",{className:"card-text"},this.props.activeNews.body)))))}}]),t}(l.Component);t["default"]=(0,p.connect)(i,{getNews:f.getNews,destroyActiveNews:f.destroyActiveNews})(m)},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function i(e){return{authenticated:e.authentication.authenticated,role:e.authentication.role}}Object.defineProperty(t,"__esModule",{value:!0});var u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=n(6),f=r(c),p=n(19),d=n(11),m=n(4),y=function(e){function t(){return o(this,t),a(this,Object.getPrototypeOf(t).apply(this,arguments))}return s(t,e),l(t,[{key:"onSubmit",value:function(e){this.props.createPost(e)}},{key:"render",value:function(){var e=this;if(!this.props.authenticated||0==this.props.role)return f["default"].createElement("div",null,"Loading...");var t=this.props,n=t.fields,r=n.title,o=n.body,a=n.news_image,s=t.handleSubmit;return f["default"].createElement("div",{className:"row"},f["default"].createElement("div",{className:"col-md-offset-3 col-md-6",
style:{marginTop:"1em"}},f["default"].createElement("form",{onSubmit:s(function(t){return e.onSubmit(t)})},f["default"].createElement("h3",null,"Create A New Post"),f["default"].createElement("div",{className:"form-group"},f["default"].createElement("label",null,"Title"),f["default"].createElement("input",u({type:"text",className:"form-control"},r))),f["default"].createElement("div",{className:"form-group"},f["default"].createElement("label",null,"Body"),f["default"].createElement("textarea",u({className:"form-control"},o))),f["default"].createElement("div",{className:"form-group"},f["default"].createElement("label",null,"Upload a file"),f["default"].createElement("input",u({type:"file",className:"form-control"},a,{value:null}))),f["default"].createElement("button",{type:"submit",className:"btn btn-primary"},"Submit"),f["default"].createElement(m.Link,{to:"/",className:"btn btn-danger",style:{marginLeft:10}},"Cancel"))))}}]),t}(c.Component);t["default"]=(0,p.reduxForm)({form:"PostsNewNews",fields:["title","body","news_image"]},i,{createPost:d.createPost})(y)},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();t["default"]=function(e){function t(e){return{authenticated:e.authentication.authenticated,role:e.authentication.role}}var n=function(t){function n(){return o(this,n),a(this,Object.getPrototypeOf(n).apply(this,arguments))}return s(n,t),i(n,[{key:"componentWillMount",value:function(){this.props.authenticated&&0!=this.props.role||this.context.router.push("/signin")}},{key:"componentWillUpdate",value:function(e){e.authenticated&&0!=e.role||this.context.router.push("/signin")}},{key:"render",value:function(){return l["default"].createElement(e,this.props)}}]),n}(u.Component);return n.contextTypes={router:l["default"].PropTypes.object},(0,c.connect)(t)(n)};var u=n(6),l=r(u),c=n(13)},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function i(e){return{authentication:e.authentication}}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(6),c=r(l),f=n(4),p=n(13),d=n(20),m=function(e){function t(){return o(this,t),a(this,Object.getPrototypeOf(t).apply(this,arguments))}return s(t,e),u(t,[{key:"redirectAuth",value:function(){this.props.authentication.authenticated?this.props.signout():f.browserHistory.push("/signin")}},{key:"renderRole",value:function(){return 1==this.props.authentication.role?c["default"].createElement(f.Link,{to:"/create/news"},c["default"].createElement("button",{type:"button",className:"dropdown-item"},"Create News")):c["default"].createElement("div",null)}},{key:"renderCreatePost",value:function(){var e=this;return this.props.authentication.authenticated?c["default"].createElement("li",{className:"nav-item active"},c["default"].createElement("div",{className:"btn-group"},c["default"].createElement("button",{className:"btn top_nav_buttons dropdown-toggle",type:"button",id:"dropdownMenuButton","data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false"},"Navigation"),c["default"].createElement("div",{className:"dropdown-menu","aria-labelledby":"dropdownMenuButton",style:{borderRadius:0,backgroundColor:"#e04226"}},this.renderRole(),c["default"].createElement("button",{type:"button",className:"dropdown-item",onClick:function(){return e.redirectAuth()}},"Sign out")))):c["default"].createElement("li",{className:"nav-item"},c["default"].createElement("button",{type:"button",className:"btn top_nav_buttons",onClick:function(){return e.redirectAuth()}},"Sign in"))}},{key:"render",value:function(){var e;return e=this.props.authentication.authenticated?"Sign out":"Sign in",c["default"].createElement("div",null,c["default"].createElement("div",{className:"row"},c["default"].createElement("div",{className:"col-xs-offset-3 col-xs-6 col-sm-offset-4 col-sm-4 col-md-offset-5 col-md-2 col-lg-offset-0 col-lg-2"},c["default"].createElement("img",{style:{width:"100%"},src:"http://samaggisamagom.org/resources/samaggi.jpg"})),c["default"].createElement("div",{className:"col-xs-12 col-md-12 col-lg-10 top_nav"},c["default"].createElement("nav",{className:"navbar"},c["default"].createElement("button",{className:"navbar-toggler hidden-lg-up",type:"button","data-toggle":"collapse","data-target":"#exCollapsingNavbar2"},"☰"),c["default"].createElement("div",{className:"collapse navbar-toggleable-md",id:"exCollapsingNavbar2"},c["default"].createElement("ul",{className:"nav navbar-nav"},c["default"].createElement("li",{className:"nav-item active"},c["default"].createElement(f.Link,{to:"/"},c["default"].createElement("button",{type:"button",className:"btn top_nav_buttons"},"Home"))),c["default"].createElement("li",{className:"nav-item active"},c["default"].createElement(f.Link,{to:"/news?page=1"},c["default"].createElement("button",{type:"button",className:"btn top_nav_buttons"},"News"))),c["default"].createElement("li",{className:"nav-item"},c["default"].createElement("button",{type:"button",className:"btn top_nav_buttons"},"Events")),c["default"].createElement("li",{className:"nav-item"},c["default"].createElement("input",{type:"text",className:"form-control",placeholder:"Search"})),this.renderCreatePost()))))),this.props.children)}}]),t}(l.Component);t["default"]=(0,p.connect)(i,{signout:d.signout})(m)},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(27),a=n(28),s=n(19),i=n(29),u=r(i),l=(0,o.combineReducers)({allNews:a.news,form:s.reducer,activeNews:a.news_active,authentication:u["default"],news_pagination:a.news_pagination});t["default"]=l},function(e,t){e.exports=require("redux")},function(e,t,n){"use strict";function r(){var e=arguments.length<=0||void 0===arguments[0]?[]:arguments[0],t=arguments[1];switch(t.type){case s.PAGE_NEWS:return t.payload.data.news;case s.TOP_NEWS:return t.payload.data.news}return e}function o(){var e=arguments.length<=0||void 0===arguments[0]?null:arguments[0],t=arguments[1];switch(t.type){case s.ACTIVE_NEWS:return t.payload.data.news}return e}function a(){var e=arguments.length<=0||void 0===arguments[0]?{page:null,maxNews:10,maxPage:10}:arguments[0],t=arguments[1];switch(t.type){case s.PAGINATION_NEWS:return{page:t.page,maxNews:t.payload.data.maxNews,maxPage:t.payload.data.maxPage}}return e}Object.defineProperty(t,"__esModule",{value:!0}),t.news=r,t.news_active=o,t.news_pagination=a;var s=n(11)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};t["default"]=function(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],t=arguments[1];switch(t.type){case o.AUTH_USER:return r({},e,{error:"",authenticated:!0,role:t.role});case o.UNAUTH_USER:return r({},e,{authenticated:!1,role:0});case o.AUTH_ERROR:return r({},e,{error:t.payload})}return e};var o=n(20)},function(e,t){e.exports=require("path")},function(e,t,n){"use strict";var r=n(1),o=r.Router(),a=n(32),s=n(33),i=n(34),u=n(35),l=n(36),c=n(37),f=u.diskStorage({destination:function(e,t,n){n(null,"./news_images")},filename:function(e,t,n){c.randomBytes(20,function(e,r){e&&console.log(e),n(null,r.toString("hex")+"-"+Date.now()+"."+l.extension(t.mimetype))})}}),p=u({storage:f});o.use(a.json()),o.use(a.urlencoded({extended:!0}));var d=6,m=/[a-z0-9!#$%&'*+\/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+\/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?/,y=/(?=.*\d)(?=.*[a-z])(?=.*[A-Z]).{6,}/,h=n(38),b=h.createConnection({host:"localhost",user:"TAHNIK",password:"jE*ah5jU",database:"SAMAGGI"}),g=0,v="x32PA5ERecH2T7UChageJ?5$$su?E7ab";b.connect();var w=function(e,t){return e.status("200").json(t)},E=function(e,t,n,r){var o="SELECT * FROM user_roles WHERE user_id="+t;b.query(o,function(t,o){return t?e.status("500").json({success:!1,message:"Internal Server Error. Try again"}):(n.role=o[0].role,void r(n))})},_=function(e,t,n,r){console.log("User id is: "+t);var o="INSERT INTO user_roles (user_id, role) VALUES("+t+","+g+")";b.query(o,function(t,o){return t?e.status("500").json({success:!1,message:"Internal Server Error. Try again"}):(n.role=g,void r(n))})},O=function(e,t,n){return console.log("Checking credentials"),null===m.exec(e.body.email)?t.status("400").json({success:!1,message:"Email not valid"}):null===y.exec(e.body.password)?t.status("400").json({success:!1,message:"Password not valid"}):e.body.expiresIn?void n():t.status("400").json({success:!1,message:"No expiresIn in the body"})},N=function(e,t,n,r){console.log("Checking user's existence");var o="SELECT COUNT(*) AS USER_EXISTS FROM users WHERE email="+b.escape(e.body.email);b.query(o,function(e,o){if(e)return t.status("500").json({succes:!1,message:"Internal Server Error"});if(n){if(o[0].USER_EXISTS)return t.json({success:!1,message:"User already exists"})}else if(!o[0].USER_EXISTS)return t.json({success:!1,message:"User doesn't exists"});r()})},j=function(e,t,n){var r="SELECT * FROM users WHERE email="+b.escape(e.body.email);b.query(r,function(r,o){if(r)console.log(r);else{var a=o[0].id,u=o[0].email,l=o[0].salt,c=o[0].password,f=e.body.password;if(s.hashSync(f,l)===c){var p=i.sign({email:u,id:o[0].id},v,{expiresIn:e.body.expiresIn}),d={success:!0,message:"Enjoy your token",token:p};n(a,d)}else t.json({success:!1,message:"User authentication failed. Wrong password"})}})},P=function(e,t,n){console.log("Signing Up");var r=s.genSaltSync(10),o=s.hashSync(e.body.password,r),a="INSERT INTO users (email, password, salt) VALUES("+b.escape(e.body.email)+","+b.escape(o)+","+b.escape(r)+")";b.query(a,function(r,o){if(r)return t.status("500").json({success:!1,message:"Internal Server Error. Try again"});var a=o.insertId,s=i.sign({email:e.body.email,id:a},v,{expiresIn:e.body.expiresIn}),u={success:!0,id:a,token:s};n(a,u)})};o.post("/signup",function(e,t){O(e,t,function(){N(e,t,!0,function(){P(e,t,function(e,n){_(t,e,n,function(e){w(t,e)})})})})}),o.post("/signin",function(e,t){O(e,t,function(){N(e,t,!1,function(){j(e,t,function(e,n){E(t,e,n,function(e){w(t,e)})})})})}),o.post("/verifyToken",function(e,t){i.verify(e.body.token,v,function(e,n){if(e)return t.status("401").json({success:!1,message:"Wrong token"});var r="SELECT role FROM user_roles where id="+n.id;b.query(r,function(e,r){return e?t.status("500").json({success:!1,message:"Internal server error"}):(n.role=r[0].role,n.success=!0,t.status("200").json(n))})})}),o.get("/news",function(e,t){R(e,t,S)});var S=function(e,t,n){var r=Math.ceil(t/d);if(console.log(r),e>r)return n.json({success:!1,message:"Page doesn't exists"});var o=t-(e-1)*d,a="SELECT * FROM news WHERE id <= "+o+" ORDER BY id DESC LIMIT "+d;b.query(a,function(e,o){return e?void console.log(e):n.json({success:!0,news:o,maxNews:t,maxPage:r})})},R=function(e,t,n){var r="SELECT MAX(id) as MAX_NEWS_ID FROM news";b.query(r,function(r,o){r?console.log(r):n(e.query.page,o[0].MAX_NEWS_ID,t)})};o.get("/news/top",function(e,t){var n="SELECT * FROM news ORDER BY id DESC LIMIT 5";b.query(n,function(e,n){return e?void console.log(e):t.json({success:!0,news:n})})}),o.get("/news/:id",function(e,t){var n="SELECT * FROM news WHERE id="+e.params.id;b.query(n,function(e,n){return e?void console.log(e):t.json({success:!0,news:n[0]})})}),o.post("/news",p.single("news_image"),function(e,t){return console.log(e.body.token),e.body.token||e.body.Token?void i.verify(e.body.token,v,function(n,r){if(n)return t.json({success:!1,message:"Token is not valid"});var o=e.body.title,a=e.body.body,s=r.id,i="SELECT role FROM user_roles where id="+s;b.query(i,function(n,r){if(n)return t.status("500").json({success:!1,message:"Internal server error"});if(1!=r[0].role)return t.status("401").json({success:!1,message:"You are not authorized to perform this action"});if(""==o&&""==a)return t.json({success:!1,message:"News Title or Body is empty"});var i="INSERT INTO news (user_id, title, image_path, body) VALUES("+b.escape(s)+","+b.escape(o)+","+b.escape(e.file.filename)+","+b.escape(a)+")";b.query(i,function(e,n){return e?(console.log(e),void t.json({success:!1,message:"Failed to insert data"})):t.json({success:!0})})})}):t.json({success:!1,message:"No token provided"})}),e.exports=o},function(e,t){e.exports=require("body-parser")},function(e,t){e.exports=require("bcrypt")},function(e,t){e.exports=require("jsonwebtoken")},function(e,t){e.exports=require("multer")},function(e,t){e.exports=require("mime")},function(e,t){e.exports=require("crypto")},function(e,t){e.exports=require("mysql")},function(e,t,n){"use strict";var r=n(1),o=r.Router(),a=n(30),s=n(40),i=n(41);o.get("/*",function(e,t){var n=a.join(".",e.originalUrl);s.readFile(n,function(e,n){return e?console.error(e):void i(n).resize(800,600).toBuffer(function(e,n){return t.send(n)})})}),e.exports=o},function(e,t){e.exports=require("fs")},function(e,t){e.exports=require("sharp")},function(e,t){e.exports=require("cors")},function(e,t){e.exports=require("morgan")}]);